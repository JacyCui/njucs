# 计算机网络-Review05 网络安全

**201220014 崔家才**



[TOC]



## 被动攻击与主动攻击的概念

- 被动攻击
    - 窃听网络传输的内容，但是不干扰网络传输的过程；
    - 很难发现，但是可以阻止；
- 主动攻击
    - 伪装身份、重发（阻塞捕获重传）、篡改内容、拒绝服务；
    - 很难阻止，但是可以发现；



## 对称加密

### 加密机制的组成元素

- 明文、密文
- 加密算法、解密算法
- 密钥
    - 对称密钥系统
    - 公开密钥系统

### 对加密机制的要求

- 可用性，防止中断；
    - 保证资源的可用性；
- 机密性，防止窃听；
    - 只有通信的双方能够理解消息的内容；
- 完整性，防止修改；
    - 保证报文无法在不被发现的情况下被修改；
- 可靠性，防止伪造；
    - 收发双方能够确认对方身份的真实性。

### 常见的加密算法

#### 经典算法

- 替换方法

    > 将字母表中的字母替换成其他的字母、数字、符号。

    - 凯撒密码（Caesar Cipher）
    - 单表密码（monoalphabetic cipher）
    - 维吉尼亚密码（Vigenere Cipher）

- 调换方法

    > 在不修改输入字符的基础上重组字符的位置。

    - 篱笆密码（Rail Fence Cipher）
    - 行列密码（Row-Column Cipher）

#### 现代算法

- 快密码

    > 按照一定的快大小处理明文，然后产生大小相同的密码块。

    - 数据加密标准（Data encryption standard，DES）
    - 三重数据加密标准（Triple DES，TDES）
    - 高级加密标准（Advanced Encryption Standard，AES）



## 非对称加密算法（RSA算法）

### 密钥生成过程

1. 选择两个大素数$p$和$q$（素数越大，加密效果越好）。
2. 计算$n = pq$和$z = (p - 1)(q - 1)$。
3. 选择$e < n$，使得$(e, z) = 1$（$e$将被用于加密）。
4. 求$d$使得$ed \mod z = 1$（$d$将被用于解密）。
5. 公钥$K^+ = (n, e)$，私钥$K^- = (n, d)$。

### RSA加密和解密计算过程

加密整数$m$表示的比特组合，$m < n$，密文$c$满足：
$$
c = m^e \mod n
$$
其中用到了公钥$K^+ = (n, e)$。

对于报文$c$进行解密：
$$
m = c^d\mod n
$$
其中用到了私钥$K^- = (n, d)$。

> RSA的算法的安全性依赖于目前不存在高效的质因数分解算法，无法快速把$n$分解成$pq$。

数学原理：
$$
m^{ed} \mod n = m^1 \mod n = m 
$$


## 报文鉴别与散列函数

### 报文鉴别的要求

- 完整性
    - 确认报文的完整性，没有错漏
- 真实性
    - 确认报文发送者的身份真实性

### 报文鉴别的可能方式

#### 报文鉴别码

1. A生成报文$m$，使用鉴别密钥（authentication key）$s$级联$m$以生成$m + s$，并计算散列值$H(m + s)$（例如使用SHA-1），$H(m + s)$被称为报文鉴别码（Message Authentication Code，MAC）；
2. 然后A将MAC附加到$m$上，生成一个扩展报文$(m, H(m + s))$，并将该扩展报文发给B；
3. B接收到一个扩展报文$(m, h)$，由于知道$s$，计算$H(m + s)$。如果$H(m + s) = h$，B得到结论：一切正常。

#### 数字签名

原本我们使用公钥加密，私钥解密的，其实也可以反过来，用私钥加密，公钥解密，即验证$K^+(K^-(m)) = m$。据次，我们得到了下面的性质：

- 无论是谁签署这个报文，都必定在计算签名$K^-(m)$的过程中使用了$K^-$这个私钥；
- 知道$K^-$这个私钥的人是唯一的（除非物理泄漏）。

不过，用公私钥加密解密整个文档时昂贵的，我们一半用它来处理$H(m)$。于是，通过$K^+(K^-(h)) = H(m)$，我们即可同时验证真实性与完整性。



## 公钥系统

### 公钥加密机制的组成元素

- 明文、密文
- 加密算法、解密算法
- 公钥、私钥

$$
Decrypt(Encrypt(M, PUB_A), PRV_A) = M\\Decrypt(Encrypt(M, PRV_A), PUB_A) = M\\
$$

### 加密和数字签名

见3.2与4.2.2。

### Diffie-Hellman 密钥交换过程

> Diffie-Hellman密钥交换方法在发送和接收双方见建立了一个“秘密通信方法”，目的是为了能够在公共平台发送秘密数据。

1. 有两个公开的参数，一个素数$p$，一个原根$g$；
2. A选择一个随机数$x \in Z^*_p$，计算$g^x\mod p$发送给B；
3. B选择一个随机数$y\in Z^*_p$，计算$g^y\mod p$发送给A；
4. 于是A和B共享了信息$g^{xy} \mod p$。

### 数字证书的概念和构造

要使公钥密码有用，需要能够证实你具有的公钥实际上就是与你要进行通信的实体（人员、路由器、浏览器等）的公钥。将公钥与特定实体绑定通常是由认证中心（Certification Authority, CA）完成的。CA的职责就是使识别和发行证书合法化。

- CA证实一个实体的证实身份。
- 一旦CA验证了某个实体的身份，这个CA会生成一个将其身份和实体的公钥绑定起来的证书。
    - 这个证书用CA的私钥加密，然后我们可以用CA的公钥对证书解密来确认实体的身份。

### 安全电子邮件系统设计

Alice：

1. Alice选择一个随机对称会话密钥$K_S$；
2. 用这个密钥加密它的报文$m$；
3. 用Bob的公钥$K_B^+$加密这个对称密钥；
4. 级联该加密的报文和加密的对称密钥以形成一个“包”；
5. 向Bob的电子邮件地址发送这个包。

Bob：

1. Bob收到这个包时，他使用自己的私钥$K_B^-$得到对称密钥$K_S$；
2. 使用这个对称密钥$K_S$解密报文$m$。

> 保证机密性，不过不保证完整性和真实性。如果需要完整性与真实性，需要加上摘要（使用哈希实现）和签名的部分。



